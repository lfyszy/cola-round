{{ self.title() }}

{{ s('background') }}

2024 年 7 月 19 日，《君の名は。》在中国重映。

{{ s('description') }}

小 L 带着小 Y 姐姐去看电影《君の名は。》。

电影院为了庆祝重映在检票厅门口发放电影的周边，其中就有人物的Q版印章。

印章被摆在一个 $N\times M$ 的网格中，使用时会有工作人员按网格的排列方式将印章印在纸上。

{{ img('0.png', size = 0.3, align = 'middle', inline = True, env = ['tex', 'md']) }}

但小 Y 姐姐并不想这样，他有自己想要的印章排列方式。

这时工作人员告诉他们，想要改变印章的摆法，可以使用以下几个与电影有关的操作来移动印章：

- 【口嚼酒】：该操作可以将两个相邻（即拥有一条公共边）的印章进行交换。

{{ img('1.png', size = 0.3, align = 'middle', inline = True, env = ['tex', 'md']) }}

- 【黄昏之时】：该操作可将一个 $2\times 2$ 的矩形顺时针旋转 $90^{\circ}$。

{{ img('2.png', size = 0.3, align = 'middle', inline = True, env = ['tex', 'md']) }}

- 【陨石】：该操作可将一个区域替换为任意的一个与其形状相同的预设（预设由工作人员给出）。

{{ img('3.png', size = 0.3, align = 'middle', inline = True, env = ['tex', 'md']) }}

但小 Y 姐姐并不太聪明，不知道怎么操作才能把印章移成她想要的样子，而小 L 着急的拉着小 Y 进场了，所以这个问题就交给你解决了~~

{{ s('input format') }}

{{ self.input_file() }}

第一行输入两个整数 $N,M$，含义如题面所示。

对于接下来 $N$ 行，第 $i$ 行输入一个字符串 $s_{i,1},s_{i,2},s_{i,3}\dots s_{i,m}$，其中 $s_{i,j}$ 表示在初始组合中，位于第 $i$ 行第 $j$ 列的印章的种类。

接下来是一个空行。

对于接下来 $N$ 行，第 $i$ 行输入一个字符串 $t_{i,1},t_{i,2},t_{i,3}\dots t_{i,m}$，其中 $t_{i,j}$ 表示在目标组合中，位于第 $i$ 行第 $j$ 列的印章的种类。 

接下来输入 $K$ 个预设。

对于第 $p$ 个预设：

首先输入两个整数 $n_p,m_p$，代表该预设对应的的子矩阵大小。

对于接下来的 $n_p$ 行，第 $i$ 行输入一个字符串 $f_{p,i,1},f_{p,i,2},f_{p,i,3}\dots f_{p,i,m_p}$，其中 $f_{p,i,j}$ 表示在第 $p$  个预设中，位于第 $i$ 行第 $j$ 列的印章的种类。

总会会有 $62$ 种不同的印章，用字符 ‘a’~’z’，’A’~’Z’，’0’~’9’ 表示。

{{ s('output format') }}

{{ self.output_file() }}

如果不存在合法的操作序列，请输出 $-1$。

否则，在第一行输出一个整数 $r$（$1\le r\le4\times10^5$），代表需要的操作次数。

接下来输出 $r$ 行，表示一个作用于当前印章组合的操作。你需要按执行操作的顺序输出，可用操作如下：

- $-4\text{ }x\text{ }y$：交换位于 $(x,y)$ 与 $(x-1,y)$ 的印章。需要满足 $1<x≤n$ 以及 $1≤y≤m$
- $-3\text{ }x\text{ }y$：交换位于 $(x,y)$ 与 $(x+1,y)$ 的印章。需要满足 $1≤x<n$ 以及 $1≤y≤m$
- $-2\text{ }x\text{ }y$：交换位于 $(x,y)$ 与 $(x,y-1)$ 的印章。需要满足 $1≤x≤n$ 以及 $1<y≤m$
- $-1\text{ }x\text{ }y$：交换位于 $(x,y)$ 与 $(x,y+1)$ 的印章。需要满足 $1≤x≤n$ 以及 $1≤y<m$
- $0\text{ }x\text{ }y$：顺时针旋转位于 $(x,y)$，$(x+1,y)$，$(x+1,y+1)$，$(x,y+1)$ 的印章。需要满足 $1≤x<n$ 以及 $1≤y<m$
- $op\text{ }x\text{ }y$：使用一次预设 $op$，将所有位于 $(i,j)$（满足 $x≤i≤x+n_{op}-1$ 以及 $y≤j≤y+m_{op}-1$）替换为预设。要求满足 $1≤op≤k,1≤x≤n-n_{op}+1,1≤y≤m-m_{op}+1$。

此外，还额外限制了⌈陨石⌋操作的使用次数不能超过 $400$。可以证明如果存在合法的操作序列，至少存在一种操作序列满足以上限制。

请注意，您并不需要最小化操作数量。若有多种方案，输出任意一种即可。

{{ s('sample', 1) }}

{{ self.sample_text() }}

{{ s('sample', 2) }}

{{ self.sample_text() }}

{{ s('sample', 3) }}

{{ self.sample_text() }}

{{ s('sample', 4) }}

{{ self.sample_file() }}

{{ s('sample', 5) }}

{{ self.sample_file() }}

{{ s('sample', 6) }}

{{ self.sample_file() }}

{{ s('subtasks') }}

{{ tbl('data') }}

{{ s('hint') }}

本题下发了 checker.exe，请按照以下方式使用：

`checker.exe [输入文件的路径] [输出文件的路径] [答案文件的路径]`